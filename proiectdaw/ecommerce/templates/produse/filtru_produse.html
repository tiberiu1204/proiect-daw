{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Filtru Produse</title>
    <link rel="stylesheet" type="text/css" href="{% static 'ecommerce/css/style.css' %}">
</head>
<body>
    <div class="container">
        <h1>Filtru Produse</h1>
        <form id="filtru-form">
            {{ form.as_p }}
            <button type="submit">Filtreaza</button>
        </form>
        <ul id="lista-produse">
            {% for produs in produse %}
                <li>
                    <h2>{{ produs.nume_produs }}</h2>
                    <p class="produs-pret">{{ produs.pret }} RON</p>
                    <p class="produs-descriere">{{ produs.descriere }}</p>
                </li>
            {% endfor %}
        </ul>
    </div>
    <script>
        const form = document.getElementById('filtru-form');
        const listaProduse = document.getElementById('lista-produse');
        form.addEventListener('submit', function(event) {
            event.preventDefault();
            const formData = new FormData(form);
            const queryString = new URLSearchParams(formData).toString();
            fetch(`?${queryString}`, {
                headers: { 'X-Requested-With': 'XMLHttpRequest' }
            })
            .then(response => response.json())
            .then(data => {
                listaProduse.innerHTML = '';
                data.produse.forEach(produs => {
                    const li = document.createElement('li');
                    li.innerHTML = `
                        <h2>${produs.nume_produs}</h2>
                        <p class="produs-pret">${produs.pret} RON</p>
                        <p class="produs-descriere">${produs.descriere}</p>
                    `;
                    listaProduse.appendChild(li);
                });
            })
            .catch(error => console.error('Eroare la filtrarea produselor:', error));
        });
    </script>
</body>
</html>

